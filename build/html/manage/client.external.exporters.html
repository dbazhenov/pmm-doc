


    <title>Using External Exporters &mdash; Percona Monitoring and Management Documentation</title>
    
  <head>
    
    
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Percona Monitoring and Management Documentation" href="../index.html" />
    <link rel="next" title="Adding annotations" href="client.annotations.html" />
    <link rel="prev" title="QAN for MongoDB" href="../qan.mongodb.html" /> 
  </head>
  <body>
    <div class="container">  

    <div class="document row">
      <div class="documentwrapper col-md-9 col-md-push-3">
    <div class="related row">
      
      <ul class="nav nav-pills">
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="client.annotations.html" title="Adding annotations"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../qan.mongodb.html" title="QAN for MongoDB"
             accesskey="P">previous</a></li>
        <li><a href="../index.html">Percona Monitoring and Management Documentation</a></li> 
      </ul>
    </div>
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="using-external-exporters">
<span id="pmm-admin-external-exporters"></span><h1><span class="xref std std-ref">Using External Exporters</span><a class="headerlink" href="#using-external-exporters" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pmm-pmm-admin-external-monitoring-service-adding">
<span id="id1"></span><h2><a class="reference external" href="pmm-admin.html#pmm-pmm-admin-external-monitoring-service-adding">Adding external monitoring services</a><a class="headerlink" href="#pmm-pmm-admin-external-monitoring-service-adding" title="Permalink to this headline">¶</a></h2>
<p>The <strong class="program">pmm-admin add</strong> command is also used to add external <a class="reference internal" href="../glossary.terminology.html#external-monitoring-service"><span class="std std-ref">monitoring
services</span></a>. This command adds an external
monitoring service assuming that the underlying Prometheus exporter is already
set up and accessible. The default scrape timeout is 10 seconds, and the
interval equals to 1 minute.</p>
<p>To add an external monitoring service use the <code class="xref std std-option docutils literal"><span class="pre">external:service</span></code> monitoring
service followed by the port number, name of a Prometheus job. These options
are required. To specify the port number the <code class="xref std std-option docutils literal"><span class="pre">--service-port</span></code> option.</p>
<div class="highlight-bash" id="pmm-admin-add-external-service-service-port-postgresql"><div class="highlight"><pre><span></span>$ pmm-admin add external:service --service-port<span class="o">=</span><span class="m">9187</span> postgresql

pmm-admin <span class="m">1</span>.12.0

PMM Server      <span class="p">|</span> <span class="m">127</span>.0.0.1:80
Client Name     <span class="p">|</span> percona
Client Address  <span class="p">|</span> <span class="m">172</span>.17.0.1
Service Manager <span class="p">|</span> linux-systemd

...

Job name    Scrape interval  Scrape timeout  Metrics path  Scheme  Target           Labels              Health
postgresql  10s              1m              /metrics      http    <span class="m">172</span>.17.0.1:9187  <span class="nv">instance</span><span class="o">=</span><span class="s2">&quot;percona&quot;</span>
</pre></div>
</div>
<p>By default, the <strong class="program">pmm-admin add</strong> command automatically creates the name of the
host to be displayed in the <span class="guilabel">Host</span> field of the
<em>Advanced Data Exploration</em> dashboard where the metrics of the newly added
external monitoring service will be displayed. This name matches the name of the
host where <strong class="program">pmm-admin</strong> is installed. You may choose another display name when
adding the <code class="xref std std-option docutils literal"><span class="pre">external:service</span></code> monitoring service giving it explicitly after
the Prometheus exporter name.</p>
<p>You may also use the <code class="xref std std-option docutils literal"><span class="pre">external:metrics</span></code> monitoring service. When using this
option, you refer to the exporter by using a URL and a port number. The
following example adds an external monitoring service which monitors a
PostgreSQL instance at 192.168.200.1, port 9187. After the command completes,
the <strong class="program">pmm-admin list</strong> command shows the newly added external exporter at the
bottom of the command&#8217;s output:</p>
<p>Run this command as root or by using the <strong class="program">sudo</strong> command</p>
<div class="highlight-text" id="pmm-admin-add-external-metrics-postgresql"><div class="highlight"><pre><span></span>$ pmm-admin add external:metrics postgresql 192.168.200.1:9187

PMM Server      | 192.168.100.1
Client Name     | percona
Client Address  | 192.168.200.1
Service Manager | linux-systemd

-------------- -------- ----------- -------- ------------ --------
SERVICE TYPE   NAME     LOCAL PORT  RUNNING  DATA SOURCE  OPTIONS
-------------- -------- ----------- -------- ------------ --------
linux:metrics  percona  42000       YES                 -


Name      Scrape interval  Scrape timeout  Metrics path  Scheme  Instances
postgres  10s              1m              /metrics      http    192.168.200.1:9187
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt>View all added monitoring services</dt>
<dd>See <a class="reference internal" href="client.list.html#pmm-admin-list"><span class="std std-ref">Listing monitoring services</span></a></dd>
<dt>Use the external monitoring service to add PostgreSQL running on an Amazon RDS instance</dt>
<dd>See <span class="xref std std-ref">use-case.external-monitoring-service.postgresql.rds</span></dd>
</dl>
</div>
</div>
<div class="section" id="pmm-pmm-admin-monitoring-service-pass-parameter">
<span id="id2"></span><h2><a class="reference external" href="pmm-admin.html#pmm-pmm-admin-monitoring-service-pass-parameter">Passing options to the exporter</a><a class="headerlink" href="#pmm-pmm-admin-monitoring-service-pass-parameter" title="Permalink to this headline">¶</a></h2>
<p><strong class="program">pmm-admin add</strong> sends all options which follow <code class="xref std std-option docutils literal"><span class="pre">--</span></code> (two consecutive
dashes delimited by whitespace) to the Prometheus exporter that the given
monitoring services uses. Each exporter has its own set of options.</p>
<p>Run the following commands as root or by using the <strong class="program">sudo</strong> command.</p>
<div class="literal-block-wrapper docutils container" id="pmm-pmm-admin-monitoring-service-pass-parameter-example">
<div class="code-block-caption"><span class="caption-text">Passing <code class="code docutils literal"><span class="pre">--collect.perf_schema.eventsstatements</span></code> to the
<code class="xref std std-option docutils literal"><span class="pre">mysql:metrics</span></code> monitoring service</span><a class="headerlink" href="#pmm-pmm-admin-monitoring-service-pass-parameter-example" title="Permalink to this code">¶</a></div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ pmm-admin add mysql:metrics -- --collect.perf_schema.eventsstatements
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="pmm-pmm-admin-monitoring-service-pass-parameter-example2">
<div class="code-block-caption"><span class="caption-text">Passing <code class="xref std std-option docutils literal"><span class="pre">--collect.perf_schema.eventswaits=false</span></code> to the
<code class="xref std std-option docutils literal"><span class="pre">mysql:metrics</span></code> monitoring service</span><a class="headerlink" href="#pmm-pmm-admin-monitoring-service-pass-parameter-example2" title="Permalink to this code">¶</a></div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ pmm-admin add mysql:metrics -- --collect.perf_schema.eventswaits<span class="o">=</span><span class="nb">false</span>
</pre></div>
</div>
</div>
<p>The section <span class="xref std std-ref">pmm.list.exporter</span> contains all option
grouped by exporters.</p>
</div>
</div>


          </div>
        </div>
    <div class="related row">
      
      <ul class="nav nav-pills">
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="client.annotations.html" title="Adding annotations"
             >next</a></li>
        <li class="right" >
          <a href="../qan.mongodb.html" title="QAN for MongoDB"
             >previous</a></li>
        <li><a href="../index.html">Percona Monitoring and Management Documentation</a></li> 
      </ul>
    </div>
      </div>
      <div class="sphinxsidebar  col-md-3 col-md-pull-9">
        <div class="sphinxsidebarwrapper">
  
          {@ product_logo @}          

          {@ product_pdf_download @}
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal"><span class="pre">Using</span> <span class="pre">External</span> <span class="pre">Exporters</span></code></a><ul>
<li><a class="reference internal" href="#pmm-pmm-admin-external-monitoring-service-adding">Adding external monitoring services</a></li>
<li><a class="reference internal" href="#pmm-pmm-admin-monitoring-service-pass-parameter">Passing options to the exporter</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../qan.mongodb.html"
                        title="previous chapter"><code class="docutils literal"><span class="pre">QAN</span> <span class="pre">for</span> <span class="pre">MongoDB</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="client.annotations.html"
                        title="next chapter">Adding annotations</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">jQuery(document).ready(function(){ jQuery('#searchbox').show(0); });</script>
          {@ product_series @}
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <!-- div class="footer">
        &copy; Copyright Percona LLC and/or its affiliates 2009-2019.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.
    </div -->
  </div>
  </body>
