


    <title>Percona Monitoring and Management 1.11.0 &mdash; Percona Monitoring and Management Documentation</title>
    
  <head>
    
    
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Percona Monitoring and Management Documentation" href="../index.html" />
    <link rel="up" title="Percona Monitoring and Management Release Notes" href="index.html" />
    <link rel="next" title="Percona Monitoring and Management 1.10.0" href="1.10.0.html" />
    <link rel="prev" title="Percona Monitoring and Management 1.12.0" href="1.12.0.html" /> 
  </head>
  <body>
    <div class="container">  

    <div class="document row">
      <div class="documentwrapper col-md-9 col-md-push-3">
    <div class="related row">
      
      <ul class="nav nav-pills">
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1.10.0.html" title="Percona Monitoring and Management 1.10.0"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="1.12.0.html" title="Percona Monitoring and Management 1.12.0"
             accesskey="P">previous</a></li>
        <li><a href="../index.html">Percona Monitoring and Management Documentation</a></li>
          <li><a href="index.html" accesskey="U">Percona Monitoring and Management Release Notes</a></li> 
      </ul>
    </div>
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="percona-monitoring-and-management-1-11-0">
<span id="id1"></span><h1>Percona Monitoring and Management 1.11.0<a class="headerlink" href="#percona-monitoring-and-management-1-11-0" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Date:</th><td class="field-body">May, 23 2018</td>
</tr>
</tbody>
</table>
<p>For more information about this release, see the <a class="reference external" href="https://www.percona.com/blog/2018/05/23/percona-monitoring-and-management-1-11-0-is-now-available/">release announcement</a>.</p>
<p>In PMM Release 1.11.0, we&#8217;re delivering the following changes:</p>
<ul class="simple">
<li>Configurable MySQL Slow Log Rotation - Enable or Disable rotation, and specify
how many files to keep on disk</li>
<li>Predictable Graphs - We&#8217;ve updated our formulas to use aggregation functions
over time for more reliable graphs</li>
<li>MySQL Exporter Parsing of my.cnf - We&#8217;ve improved how we read my.cnf</li>
<li>Annotation improvements - Passing multiple strings results in single
annotation being written</li>
</ul>
<p>The issues in the release&nbsp;includes 1 new features &amp; improvements, and 9 bugs fixed.</p>
<div class="section" id="mysql-slow-log-rotation-improvements">
<h2>MySQL Slow Log Rotation Improvements<a class="headerlink" href="#mysql-slow-log-rotation-improvements" title="Permalink to this headline">¶</a></h2>
<p>We spent some time this release going over how we handle MySQL&#8217;s Slow Log
rotation logic. Query Analytics requires that slow logging be enabled (either to
file, or to PERFORMANCE_SCHEMA) and what we found was that Users of Percona
Server for MySQL overwhelmingly choose logging to a file in order to take
advantage of <a class="reference external" href="https://www.percona.com/doc/percona-server/LATEST/diagnostics/slow_extended.html#log_slow_verbosity">log_slow_verbosity</a>
which provides <a class="reference external" href="https://www.percona.com/doc/percona-server/LATEST/diagnostics/slow_extended.html#innodb-usage-information">enhanced InnoDB Usage information</a>.
The challenge however with MySQL&#8217;s Slow Log is that it is very verbose and
thus the number one concern is disk space - PMM strives to Do No Harm and so
doing MySQL Slow Log Rotation was a natural fit, but until this release we were
very strict and hadn&#8217;t enabled any configuration of these parameters.</p>
<p>Percona Server for MySQL Users have long known about <a class="reference external" href="https://www.percona.com/doc/percona-server/LATEST/flexibility/slowlog_rotation.html">Slow Query Log Rotation</a> and
Expiration, but until now had no way of using the in-built Percona Server
feature while ensuring that PMM wasn&#8217;t missing any queries from the Slow Log
during file rotation. Or perhaps your use case is that you want to do Slow Log
Rotation using logrotate or some other facility. Today with Release 1.11 this is
now possible!</p>
<p>We have made two significant changes:</p>
<ul class="simple">
<li>You can now specify the number of Slow Log files to remain on disk, and let
PMM handle deleting the oldest files first. <strong>Default remains unchanged - 1 Slow Log to remain on disk</strong>.</li>
<li>Slow Log rotation can now be disabled, for example if you want to manage
rotation using logrotate or Percona Server for MySQL Slow Query Log Rotation
and Expiration. <strong>Default remains unchanged - Slow Log Rotation is ON</strong>.</li>
</ul>
<p>You specify each of these two new controls when setting up the MySQL service. The following example specifies that 5 Slow Log files should remain on disk:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ pmm-admin add mysql ... --retain-slow-logs<span class="o">=</span><span class="m">5</span>
</pre></div>
</div>
<p>While the following example specifies that Slow Log rotation is to be disabled
(flag value of false), with the assumption that you will perform your own Slow
Log Rotation:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ pmm-admin add mysql ... --slow-log-rotation<span class="o">=</span><span class="nb">false</span>
</pre></div>
</div>
<p>We do not currently support modifying option parameters for an existing
service definition. This means you must remove, then re-add the service and
including the new options.</p>
<p>We are including a logrotate script in this post to get you started, and it
is designed to keep 30 copies of Slow Logs at 1GB each. Note that you will
need to update the Slow Log location, and ensure a MySQL User Account with
SUPER, RELOAD are used for this script to successfully execute.</p>
<p class="rubric">Example logrotate</p>
<div class="highlight-guess"><div class="highlight"><pre><span></span>/var/mysql/mysql-slow.log {
             nocompress
             create 660 mysql mysql
             size 1G
             dateext
             missingok
             notifempty
             sharedscripts
             postrotate
             /bin/mysql -e &#39;SELECT @@global.long_query_time INTO @LQT_SAVE; SET GLOBAL long_query_time=2000; SELECT SLEEP(2); FLUSH SLOW LOGS; SELECT SLEEP(2); SET GLOBAL long_query_time=@LQT_SAVE;&#39;
             endscript
             rotate 30
}
</pre></div>
</div>
</div>
<div class="section" id="predictable-graphs">
<h2>Predictable Graphs<a class="headerlink" href="#predictable-graphs" title="Permalink to this headline">¶</a></h2>
<p>We&#8217;ve updated the logic on 4 Dashboards to better handle predictability and
also zooming to look at shorter time ranges. For example, refreshing PXC/Galera
Graphs prior to 1.11 led to graphs spiking at different points during the metric
series. We&#8217;ve reviewed each of these Graphs and their corresponding queries
and added in &lt;aggregation&gt;_over_time() functions so that Graphs display a
consistent view of the metric series. This also improves your ability to drill
in on the Dashboards, so that no matter how short your time range, you will
still observe the same spikes and troughs in your metric series. The four
Dashboards affected by this improvement are:</p>
<ul class="simple">
<li>Home Dashboard</li>
<li>PXC/Galera Graphs Dashboard</li>
<li>MySQL Overview Dashboard</li>
<li>MySQL InnoDB Metrics Dashboard</li>
<li>MySQL Exporter Parsing of my.cnf</li>
</ul>
<p>In earlier releases, the MySQL Exporter expected only key=value type flags and
would ignore options without values (i.e. disable-auto-rehash), and could
sometimes read the wrong section of the my.cnf file. We&#8217;ve updated the parsing
engine to be more MySQL compatible.</p>
</div>
<div class="section" id="annotation-improvements">
<h2>Annotation Improvements<a class="headerlink" href="#annotation-improvements" title="Permalink to this headline">¶</a></h2>
<p>Annotations permit the display of an event on all dashboards in PMM. Users
reported that passing more than one string to <code class="docutils literal"><span class="pre">pmm-admin</span></code> annotate would generate
an error, so we updated the parsing logic to assume all strings passed during
Annotation creation generates a single Annotation event. Previously you needed
to enclose your strings in quotes so that it would be parsed as a single string.</p>
</div>
<div class="section" id="issues-in-this-release">
<h2>Issues in this release<a class="headerlink" href="#issues-in-this-release" title="Permalink to this headline">¶</a></h2>
<div class="section" id="new-features-improvements">
<h3>New Features &amp; Improvements<a class="headerlink" href="#new-features-improvements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2432">PMM-2432</a>: Configurable MySQL Slow Log File Rotation</li>
</ul>
</div>
<div class="section" id="bug-fixes">
<h3>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-1187">PMM-1187</a>: Graphs breaks at tight resolution</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2362">PMM-2362</a>: Explain is a part of query</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2399">PMM-2399</a>: RPM for PMM Server is missing some files</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2407">PMM-2407</a>: Menu items are not visible on PMM QAN dashboard</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2469">PMM-2469</a>: Parsing of a valid my.cnf can break the mysqld_exporter</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2479">PMM-2479</a>: PXC/Galera Cluster Overview dashboard: typo in metric names</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2484">PMM-2484</a>: PXC/Galera Graphs display unpredictable results each time they are refreshed</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2503">PMM-2503</a>: Wrong Innodb Adaptive Hash Index Statistics</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2513">PMM-2513</a>: QAN-agent always changes <code class="docutils literal"><span class="pre">max_slowlog_size</span></code> to <strong>0</strong></li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2514">PMM-2514</a>: <code class="docutils literal"><span class="pre">pmm-admin</span> <span class="pre">annotate</span> <span class="pre">help</span></code> - fix typos</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2515">PMM-2515</a>: <code class="docutils literal"><span class="pre">pmm-admin</span> <span class="pre">annotate</span></code> - more than 1 annotation</li>
</ul>
</div>
</div>
<div class="section" id="how-to-get-pmm">
<h2>How to get PMM<a class="headerlink" href="#how-to-get-pmm" title="Permalink to this headline">¶</a></h2>
<p>PMM is available for installation using three methods:</p>
<ul class="simple">
<li>On Docker Hub – <code class="docutils literal"><span class="pre">docker</span> <span class="pre">pull</span> <span class="pre">percona/pmm-server</span></code> <a class="reference external" href="https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/docker.html">https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/docker.html</a></li>
<li>AWS Marketplace – <a class="reference external" href="https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/ami.html">https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/ami.html</a></li>
<li>Open Virtualization Format (OVF) – <a class="reference external" href="https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/virtual-appliance.html">https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/virtual-appliance.html</a></li>
</ul>
<p>Help us improve our software quality by reporting any bugs you encounter using our <a class="reference external" href="https://jira.percona.com/secure/Dashboard.jspa">bug tracking system</a>.</p>
</div>
</div>


          </div>
        </div>
    <div class="related row">
      
      <ul class="nav nav-pills">
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1.10.0.html" title="Percona Monitoring and Management 1.10.0"
             >next</a></li>
        <li class="right" >
          <a href="1.12.0.html" title="Percona Monitoring and Management 1.12.0"
             >previous</a></li>
        <li><a href="../index.html">Percona Monitoring and Management Documentation</a></li>
          <li><a href="index.html" >Percona Monitoring and Management Release Notes</a></li> 
      </ul>
    </div>
      </div>
      <div class="sphinxsidebar  col-md-3 col-md-pull-9">
        <div class="sphinxsidebarwrapper">
  
          {@ product_logo @}          

          {@ product_pdf_download @}
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Percona Monitoring and Management 1.11.0</a><ul>
<li><a class="reference internal" href="#mysql-slow-log-rotation-improvements">MySQL Slow Log Rotation Improvements</a></li>
<li><a class="reference internal" href="#predictable-graphs">Predictable Graphs</a></li>
<li><a class="reference internal" href="#annotation-improvements">Annotation Improvements</a></li>
<li><a class="reference internal" href="#issues-in-this-release">Issues in this release</a><ul>
<li><a class="reference internal" href="#new-features-improvements">New Features &amp; Improvements</a></li>
<li><a class="reference internal" href="#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-get-pmm">How to get PMM</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="1.12.0.html"
                        title="previous chapter">Percona Monitoring and Management 1.12.0</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="1.10.0.html"
                        title="next chapter"><em>Percona Monitoring and Management</em> 1.10.0</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">jQuery(document).ready(function(){ jQuery('#searchbox').show(0); });</script>
          {@ product_series @}
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <!-- div class="footer">
        &copy; Copyright Percona LLC and/or its affiliates 2009-2019.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.
    </div -->
  </div>
  </body>
