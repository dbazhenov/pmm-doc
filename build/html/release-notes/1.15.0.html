


    <title>Percona Monitoring and Management 1.15.0 &mdash; Percona Monitoring and Management Documentation</title>
    
  <head>
    
    
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Percona Monitoring and Management Documentation" href="../index.html" />
    <link rel="up" title="Percona Monitoring and Management Release Notes" href="index.html" />
    <link rel="next" title="Percona Monitoring and Management 1.14.1" href="1.14.1.html" />
    <link rel="prev" title="Percona Monitoring and Management 1.16.0" href="1.16.0.html" /> 
  </head>
  <body>
    <div class="container">  

    <div class="document row">
      <div class="documentwrapper col-md-9 col-md-push-3">
    <div class="related row">
      
      <ul class="nav nav-pills">
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1.14.1.html" title="Percona Monitoring and Management 1.14.1"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="1.16.0.html" title="Percona Monitoring and Management 1.16.0"
             accesskey="P">previous</a></li>
        <li><a href="../index.html">Percona Monitoring and Management Documentation</a></li>
          <li><a href="index.html" accesskey="U">Percona Monitoring and Management Release Notes</a></li> 
      </ul>
    </div>
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="percona-monitoring-and-management-1-15-0">
<span id="id1"></span><h1>Percona Monitoring and Management 1.15.0<a class="headerlink" href="#percona-monitoring-and-management-1-15-0" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Date:</th><td class="field-body">October 10, 2018</td>
</tr>
</tbody>
</table>
<p><em>PMM</em> (<a class="reference external" href="https://www.percona.com/doc/percona-monitoring-and-management/index.html">Percona Monitoring and Management</a>) is a free and open-source platform for managing and monitoring <em>MySQL</em> and <em>MongoDB</em> performance. You can run <em>PMM</em> in your own environment for maximum security and reliability. It provides thorough time-based analysis for <em>MySQL</em> and <em>MongoDB</em> servers to ensure that your data works as efficiently as possible.</p>
<p>This release offers two new features for both the <em>MySQL</em> Community and Percona Customers:</p>
<ul class="simple">
<li>MySQL Custom Queries - Turn a <code class="docutils literal"><span class="pre">SELECT</span></code> into a dashboard!!</li>
<li>Server and Client logs - Collect troubleshooting logs for Percona Support</li>
</ul>
<p>We addressed 17 new features and improvements, and fixed 17 bugs.</p>
<div class="section" id="mysql-custom-queries">
<h2>MySQL Custom Queries<a class="headerlink" href="#mysql-custom-queries" title="Permalink to this headline">¶</a></h2>
<p>In 1.15 we are introducing the ability to take a SQL <code class="docutils literal"><span class="pre">SELECT</span></code> statement and turn the result set into metric series in <em>PMM</em>.  The queries are executed at the LOW RESOLUTION level, which by default is every 60 seconds.  A key advantage is that you can extend <em>PMM</em> to profile metrics unique to your environment (see users table example), or to introduce support for a table that isn&#8217;t part of <em>PMM</em> yet. This feature is on by default and only requires that you edit the configuration file and use vaild YAML syntax.  The configuration file is in <code class="docutils literal"><span class="pre">/usr/local/percona/pmm-client/queries-mysqld.yml</span></code>.</p>
<div class="section" id="example-application-users-table">
<h3>Example - Application users table<a class="headerlink" href="#example-application-users-table" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;re going to take a fictional <em>MySQL</em> users table that also tracks the number of upvotes and downvotes, and we&#8217;ll convert this into two metric series, with a set of seven labels, where each label can also store a value.</p>
<div class="section" id="browsing-metrics-series-using-advanced-data-exploration-dashboard">
<h4>Browsing metrics series using Advanced Data Exploration Dashboard<a class="headerlink" href="#browsing-metrics-series-using-advanced-data-exploration-dashboard" title="Permalink to this headline">¶</a></h4>
<p>Lets look at the output so we understand the goal - take data from a <em>MySQL</em> table and store in <em>PMM</em>, then display as a metric series.  Using the Advanced Data Exploration Dashboard you can review your metric series. Exploring the metric series <code class="docutils literal"><span class="pre">app1_users_metrics_downvotes</span></code> we see the following:</p>
<img alt="../_images/1.15.0-1.png" src="../_images/1.15.0-1.png" />
</div>
<div class="section" id="mysql-table">
<h4>MySQL table<a class="headerlink" href="#mysql-table" title="Permalink to this headline">¶</a></h4>
<p>Lets assume you have the following users table that includes true/false, string, and integer types.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>SELECT * FROM <span class="sb">`</span>users<span class="sb">`</span>
+----+------+--------------+-----------+------------+-----------+---------------------+--------+---------+-----------+
<span class="p">|</span> id <span class="p">|</span> app  <span class="p">|</span> user_type    <span class="p">|</span> last_name <span class="p">|</span> first_name <span class="p">|</span> logged_in <span class="p">|</span> active_subscription <span class="p">|</span> banned <span class="p">|</span> upvotes <span class="p">|</span> downvotes <span class="p">|</span>
+----+------+--------------+-----------+------------+-----------+---------------------+--------+---------+-----------+
<span class="p">|</span>  <span class="m">1</span> <span class="p">|</span> app2 <span class="p">|</span> unprivileged <span class="p">|</span> Marley    <span class="p">|</span> Bob        <span class="p">|</span>         <span class="m">1</span> <span class="p">|</span>                   <span class="m">1</span> <span class="p">|</span>      <span class="m">0</span> <span class="p">|</span>     <span class="m">100</span> <span class="p">|</span>        <span class="m">25</span> <span class="p">|</span>
<span class="p">|</span>  <span class="m">2</span> <span class="p">|</span> app3 <span class="p">|</span> moderator    <span class="p">|</span> Young     <span class="p">|</span> Neil       <span class="p">|</span>         <span class="m">1</span> <span class="p">|</span>                   <span class="m">1</span> <span class="p">|</span>      <span class="m">1</span> <span class="p">|</span>     <span class="m">150</span> <span class="p">|</span>        <span class="m">10</span> <span class="p">|</span>
<span class="p">|</span>  <span class="m">3</span> <span class="p">|</span> app4 <span class="p">|</span> unprivileged <span class="p">|</span> OConnor   <span class="p">|</span> Sinead     <span class="p">|</span>         <span class="m">1</span> <span class="p">|</span>                   <span class="m">1</span> <span class="p">|</span>      <span class="m">0</span> <span class="p">|</span>      <span class="m">25</span> <span class="p">|</span>        <span class="m">50</span> <span class="p">|</span>
<span class="p">|</span>  <span class="m">4</span> <span class="p">|</span> app1 <span class="p">|</span> unprivileged <span class="p">|</span> Yorke     <span class="p">|</span> Thom       <span class="p">|</span>         <span class="m">0</span> <span class="p">|</span>                   <span class="m">1</span> <span class="p">|</span>      <span class="m">0</span> <span class="p">|</span>     <span class="m">100</span> <span class="p">|</span>       <span class="m">100</span> <span class="p">|</span>
<span class="p">|</span>  <span class="m">5</span> <span class="p">|</span> app5 <span class="p">|</span> admin        <span class="p">|</span> Buckley   <span class="p">|</span> Jeff       <span class="p">|</span>         <span class="m">1</span> <span class="p">|</span>                   <span class="m">1</span> <span class="p">|</span>      <span class="m">0</span> <span class="p">|</span>     <span class="m">175</span> <span class="p">|</span>         <span class="m">0</span> <span class="p">|</span>
+----+------+--------------+-----------+------------+-----------+---------------------+--------+---------+-----------+
</pre></div>
</div>
</div>
<div class="section" id="explaining-the-yaml-syntax">
<h4>Explaining the YAML syntax<a class="headerlink" href="#explaining-the-yaml-syntax" title="Permalink to this headline">¶</a></h4>
<p>We&#8217;ll go through a simple example and mention what&#8217;s required for each line.  The metric series is constructed based on the first line and appends the column name to form metric series. Therefore the number of metric series per table will be the count of columns that are of type <code class="docutils literal"><span class="pre">GAUGE</span></code> or <code class="docutils literal"><span class="pre">COUNTER</span></code>.  This metric series will be called <code class="docutils literal"><span class="pre">app1_users_metrics_downvotes</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>app1_users_metrics:                                 <span class="c1">## leading section of your metric series.</span>
  query: <span class="s2">&quot;SELECT * FROM app1.users&quot;</span>                 <span class="c1">## Your query. Don&#39;t forget the schema name.</span>
  metrics:                                          <span class="c1">## Required line to start the list of metric items</span>
    - downvotes:                                    <span class="c1">## Name of the column returned by the query. Will be appended to the metric series.</span>
        usage: <span class="s2">&quot;COUNTER&quot;</span>                            <span class="c1">## Column value type.  COUNTER will make this a metric series.</span>
        description: <span class="s2">&quot;Number of upvotes&quot;</span>            <span class="c1">## Helpful description of the column.</span>
</pre></div>
</div>
</div>
<div class="section" id="full-queries-mysqld-yml-example">
<h4>Full queries-mysqld.yml example<a class="headerlink" href="#full-queries-mysqld-yml-example" title="Permalink to this headline">¶</a></h4>
<p>Each column in the <code class="docutils literal"><span class="pre">SELECT</span></code> is named in this example, but that isn&#8217;t required, you can use a <code class="docutils literal"><span class="pre">SELECT</span> <span class="pre">*</span></code> as well.  Notice the format of schema.table for the query is included.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>---
app1_users_metrics:
  query: <span class="s2">&quot;SELECT app,first_name,last_name,logged_in,active_subscription,banned,upvotes,downvotes FROM app1.users&quot;</span>
  metrics:
    - app:
        usage: <span class="s2">&quot;LABEL&quot;</span>
        description: <span class="s2">&quot;Name of the Application&quot;</span>
    - user_type:
        usage: <span class="s2">&quot;LABEL&quot;</span>
        description: <span class="s2">&quot;User&#39;s privilege level within the Application&quot;</span>
    - first_name:
        usage: <span class="s2">&quot;LABEL&quot;</span>
        description: <span class="s2">&quot;User&#39;s First Name&quot;</span>
    - last_name:
        usage: <span class="s2">&quot;LABEL&quot;</span>
        description: <span class="s2">&quot;User&#39;s Last Name&quot;</span>
    - logged_in:
        usage: <span class="s2">&quot;LABEL&quot;</span>
        description: <span class="s2">&quot;User&#39;s logged in or out status&quot;</span>
    - active_subscription:
        usage: <span class="s2">&quot;LABEL&quot;</span>
        description: <span class="s2">&quot;Whether User has an active subscription or not&quot;</span>
    - banned:
        usage: <span class="s2">&quot;LABEL&quot;</span>
        description: <span class="s2">&quot;Whether user is banned or not&quot;</span>
    - upvotes:
        usage: <span class="s2">&quot;COUNTER&quot;</span>
        description: <span class="s2">&quot;Count of upvotes the User has earned. Upvotes once granted cannot be revoked, so the number can only increase.&quot;</span>
    - downvotes:
        usage: <span class="s2">&quot;GAUGE&quot;</span>
        description: <span class="s2">&quot;Count of downvotes the User has earned. Downvotes can be revoked so the number can increase as well as decrease.&quot;</span>
...
</pre></div>
</div>
<p>We hope you enjoy this feature, and we welcome your feedback via the <a class="reference external" href="https://confluence.percona.com/percona.com/forums">Percona forums</a>!</p>
</div>
</div>
</div>
<div class="section" id="server-and-client-logs">
<h2>Server and Client logs<a class="headerlink" href="#server-and-client-logs" title="Permalink to this headline">¶</a></h2>
<p>We&#8217;ve enhanced the volume of data collected from both the Server and Client perspectives.  Each service provides a set of files designed to be shared with Percona Support while you work on an issue.</p>
<div class="section" id="server">
<h3>Server<a class="headerlink" href="#server" title="Permalink to this headline">¶</a></h3>
<p>From the Server, we&#8217;ve improved the <a class="reference external" href="https://pmmdemo.percona.com/managed/logs.zip">logs.zip</a> service to include:</p>
<ul class="simple">
<li>Prometheus targets</li>
<li>Consul nodes, QAN API instances</li>
<li>Amazon RDS and Aurora instances</li>
<li>Version</li>
<li>Server configuration</li>
<li>Percona Toolkit commands</li>
</ul>
<p>You retrieve the link from your <em>PMM server</em> using this format:</p>
<p><a class="reference external" href="https://pmmdemo.percona.com/managed/logs.zip">https://pmmdemo.percona.com/managed/logs.zip</a></p>
</div>
<div class="section" id="client">
<h3>Client<a class="headerlink" href="#client" title="Permalink to this headline">¶</a></h3>
<p>On the Client side we&#8217;ve added a new action called <code class="docutils literal"><span class="pre">summary</span></code> which fetches logs, network, and <em>Percona Toolkit</em> output in order to share with Percona Support. To initiate a Client side collection, execute:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>pmm-admin summary
</pre></div>
</div>
<p>The output will be a file you can use to attach to your Support ticket.  The single file will look something like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>summary__2018_10_10_16_20_00.tar.gz
</pre></div>
</div>
</div>
</div>
<div class="section" id="new-features-and-improvements">
<h2>New Features and Improvements<a class="headerlink" href="#new-features-and-improvements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2913">PMM-2913</a>: Provide ability to execute Custom Queries against MySQL - Credit to <a class="reference external" href="https://github.com/wrouesnel">wrouesnel</a> for the framework of this feature in <a class="reference external" href="https://github.com/wrouesnel/postgres_exporter">wrouesnel/postgres_exporter</a>!</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2904">PMM-2904</a>: Improve PMM Server Diagnostics for Support</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2860">PMM-2860</a>: Improve pmm-client Diagnostics for Support</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-1754">PMM-1754</a>: Provide functionality to easily select query and copy it to clipboard in QAN</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-1855">PMM-1855</a>: Add swap to AMI</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-3013">PMM-3013</a>: Rename PXC Overview graph Sequence numbers of transactions to IST Progress</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2726">PMM-2726</a>: Abort data collection in Exporters based on Prometheus Timeout - MySQLd Exporter</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-3003">PMM-3003</a>: PostgreSQL Overview Dashboard Tooltip fixes</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2936">PMM-2936</a>: Some improvements for Query Analytics Settings screen</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-3029">PMM-3029</a>: PostgreSQL Dashboard Improvements</li>
</ul>
</div>
<div class="section" id="fixed-bugs">
<h2>Fixed Bugs<a class="headerlink" href="#fixed-bugs" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2976">PMM-2976</a>: Upgrading to PMM 1.14.x fails if dashboards from Grafana 4.x are present on an installation</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2969">PMM-2969</a>: rds_exporter becomes throttled by CloudWatch API</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-1443">PMM-1443</a>: The credentials for a secured server are exposed without explicit request</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-3006">PMM-3006</a>: Monitoring over 1000 instances is displayed imperfectly on the label</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-3011">PMM-3011</a>: PMM&#8217;s default MongoDB DSN is localhost, which is not resolved to IPv4 on modern systems</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2211">PMM-2211</a>: Bad display when using old range in QAN</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-1664">PMM-1664</a>: Infinite loading with wrong queryID</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2715">PMM-2715</a>: Since pmm-client-1.9.0, pmm-admin detects CentOS/RHEL 6 installations using linux-upstart as service manager and ignores SysV scripts</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2839">PMM-2839</a>: Tablestats safety precaution does not work for RDS/Aurora instances</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2845">PMM-2845</a>: pmm-admin purge causes client to panic</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-2968">PMM-2968</a>: pmm-admin list shows empty data source column for mysql:metrics</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-3043">PMM-3043</a>: Total Time percentage is incorrectly shown as a decimal fraction</li>
<li><a class="reference external" href="https://jira.percona.com/browse/PMM-3082">PMM-3082</a>: Prometheus Scrape Interval Variance chart doesn&#8217;t display data</li>
</ul>
</div>
<div class="section" id="how-to-get-pmm-server">
<h2>How to get PMM Server<a class="headerlink" href="#how-to-get-pmm-server" title="Permalink to this headline">¶</a></h2>
<p>PMM is available for installation using three methods:</p>
<ul class="simple">
<li>On <a class="reference external" href="https://hub.docker.com/r/percona/pmm-server/">Docker Hub</a> – docker pull percona/pmm-server – <a class="reference external" href="https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/docker.html">Documentation</a></li>
<li><a class="reference external" href="https://aws.amazon.com/marketplace/pp/B077J7FYGX">AWS Marketplace</a> – <a class="reference external" href="https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/ami.html">Documentation</a></li>
<li><a class="reference external" href="https://www.percona.com/downloads/pmm/">Open Virtualization Format (OVF)</a> – <a class="reference external" href="https://www.percona.com/doc/percona-monitoring-and-management/deploy/server/virtual-appliance.html">Documentation</a></li>
</ul>
</div>
</div>


          </div>
        </div>
    <div class="related row">
      
      <ul class="nav nav-pills">
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1.14.1.html" title="Percona Monitoring and Management 1.14.1"
             >next</a></li>
        <li class="right" >
          <a href="1.16.0.html" title="Percona Monitoring and Management 1.16.0"
             >previous</a></li>
        <li><a href="../index.html">Percona Monitoring and Management Documentation</a></li>
          <li><a href="index.html" >Percona Monitoring and Management Release Notes</a></li> 
      </ul>
    </div>
      </div>
      <div class="sphinxsidebar  col-md-3 col-md-pull-9">
        <div class="sphinxsidebarwrapper">
  
          {@ product_logo @}          

          {@ product_pdf_download @}
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Percona Monitoring and Management 1.15.0</a><ul>
<li><a class="reference internal" href="#mysql-custom-queries">MySQL Custom Queries</a><ul>
<li><a class="reference internal" href="#example-application-users-table">Example - Application users table</a><ul>
<li><a class="reference internal" href="#browsing-metrics-series-using-advanced-data-exploration-dashboard">Browsing metrics series using Advanced Data Exploration Dashboard</a></li>
<li><a class="reference internal" href="#mysql-table">MySQL table</a></li>
<li><a class="reference internal" href="#explaining-the-yaml-syntax">Explaining the YAML syntax</a></li>
<li><a class="reference internal" href="#full-queries-mysqld-yml-example">Full queries-mysqld.yml example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#server-and-client-logs">Server and Client logs</a><ul>
<li><a class="reference internal" href="#server">Server</a></li>
<li><a class="reference internal" href="#client">Client</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-features-and-improvements">New Features and Improvements</a></li>
<li><a class="reference internal" href="#fixed-bugs">Fixed Bugs</a></li>
<li><a class="reference internal" href="#how-to-get-pmm-server">How to get PMM Server</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="1.16.0.html"
                        title="previous chapter">Percona Monitoring and Management 1.16.0</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="1.14.1.html"
                        title="next chapter">Percona Monitoring and Management 1.14.1</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">jQuery(document).ready(function(){ jQuery('#searchbox').show(0); });</script>
          {@ product_series @}
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <!-- div class="footer">
        &copy; Copyright Percona LLC and/or its affiliates 2009-2019.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.
    </div -->
  </div>
  </body>
